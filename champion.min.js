(function(a){"use strict";var b=this.champ={},c=(b.debug={on:!1,log:function(){this.on&&console.log&&console.log.apply(console,arguments)}},b.DOMEvents=["blur","focus","focusin","focusout","load","resize","scroll","unload","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","error"]);this.champ.views={},this.champ.models={},this.champ.presenters={},b.extend=function(a,b,c){c=c||[];for(var d in b){for(var e=0;e<c.length;e++)!(c[e]in b);a[d]=b[d]}return a},b.namespace=function h(a){if("string"==typeof a)return h.call(this,a.split("."));var b=a.splice(0,1);return this[b]=this[b]||{},0!==a.length&&h.call(this[b],a),this[b]};var d=b.events=function(){var a={};return{trigger:function(b,c){var d=a[b]||[];for(var e in d)d[e](c,b)},on:function(b,c){a[b]=a[b]||[],a[b].push(c)},off:function(b,c){for(var d=a[b]||[],e=0;e<d.length;e++)""+d[e]==""+c&&d.splice(e,1)}}}(),e=(function(){var a=[],b=function(a){var b=new RegExp(":([^/.\\\\]+)","g"),c=""+a,d=b.exec(a);return null!=d&&(c=c.replace(d[0],"([^/.\\\\]+)")),c+="$",{regex:new RegExp(c)}},c=function(b){for(var c=0;c<a.length;c++){var d=a[c],e=d.params.regex.exec(b);if(e)return d.callback({url:b}),!0}return!1},d=function(){var a=!1;0==a&&(c(document.location.pathname),a=!0),window.addEventListener("popstate",function(){c(document.location.pathname)}),window.addEventListener("load",function(){0==a&&(c(document.location.pathname),a=!0)}),window.addEventListener("hashchange",function(){c(document.location.pathname)})};return d(),{addRoute:function(c,d){a.push({params:b(c),callback:d})}}}(),b.view=function(c,d){return this instanceof e?(d=d||{},this.name=Array.prototype.splice.call(arguments,0,1),this.container=a(d.container),this.DOM=d.DOM||{},this.registerDom(this.DOM),this.registerDomEvents(),b.extend(this,d,["name","container","DOM"]),this.init.apply(this,arguments),b.namespace("views")[c]=this,void 0):new e(c,d)});b.extend(e.prototype,{init:function(){},addDom:function(a,b){b=this.container.find(b),b.length>0&&(this.DOM[a]=b)},registerDom:function(a){for(var b in a)this.addDom(b,a[b])},registerDomEvents:function(){for(var a in this.DOM){var b=this.DOM[a];b.on(c.join(" "),function(a,b){return function(c){d.trigger("view:"+a.name+":"+b+" "+c.type,c)}}(this,a))}}}),b.view.extend=function(a){return function(c,d){return b.view(c,b.extend(a,d))}};var f=b.model=function(a,c){return this instanceof f?(c=c||{},this.name=Array.prototype.splice.call(arguments,0,1)[0],this.properties=c.properties||{},b.extend(this,c,["name","properties"]),this.init.apply(this,arguments),b.namespace("models")[a]=this,void 0):new f(a,c)};b.extend(f.prototype,{init:function(){},property:function i(a,b,c){if("string"==typeof a){if(!this.properties[a]&&!b)throw"Property doesn't exist";if(!b)return this.properties[a];this.properties[a]=b,c||d.trigger("model:"+this.name+":changed",{property:a,value:b})}else for(var e in a)a.hasOwnProperty(e)&&i.call(this,e,a[e],b)}}),b.model.extend=function(a){return function(c,d){return b.model(c,b.extend(a,d))}};var g=b.presenter=function(a,c){return this instanceof g?(c=c||{},this.name=Array.prototype.splice.call(arguments,0,1),this.views=c.views||{},this.models=c.models||{},this.events=c.events||{},this.register("models",this.models),this.register("views",this.views),this.registerViewEvents(this.events),b.extend(this,c,["name","views","models","events"]),this.init.apply(this,arguments),b.namespace("presenters")[a]=this,void 0):new g(a,c)};b.extend(g.prototype,{init:function(){},register:function(a,c){var d=this[a]=this[a]||{};if("string"==typeof c)return d[c]=b.namespace(a)[c],void 0;for(var e=0;e<c.length;e++)d[c[e]]=b.namespace(a)[c[e]]},registerViewEvents:function(a){for(var b in a)d.on(b,this[a[b]].bind(this))}}),b.presenter.extend=function(a){return function(c,d){return b.presenter(c,b.extend(a,d))}}}).call(this,jQuery);