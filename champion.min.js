(function(a){"use strict";var b=this,c=b.champ={},d=c.DOMEvents=["blur","focus","focusin","focusout","load","resize","scroll","unload","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","error"];c.extend=function(a,b,c){c=c||[];for(var d in b){for(var e=0;e<c.length;e++)!(c[e]in b);a[d]=b[d]}return a},c.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})};var e=c.Class=function g(a){if(g.init="boolean"==typeof g.init?g.init:!0,a=a||{},this.id=a.id||c.guid(),g.init){for(var b in this.inject)a[this.inject[b]]=c.ioc.resolve(this.inject[b]);this._construct(a),this.init(a)}};e.prototype=c.extend(e.prototype,{_construct:function(a){this.properties=a},init:function(){},get:function(a){if("string"!=typeof a){for(var b={},c=0;c<a.length;c++)b[a[c]]=this.get(a[c]);return b}if(!a in this.properties)throw Error('"'+a+'" does not exist');return this.properties[a]},set:function(a,b){if("string"==typeof a)return-1===a.indexOf(".")?this.properties[a]=b:c.namespace.call(this.properties,a,b);for(var d in a)a.hasOwnProperty(d)&&this.set(d,a[d])}}),e.extend=function(a,b){if(arguments.length<2)throw Error("Must specify a name for extended classes");e.init=!1;var d=this,f=new this;e.init=!0;var g=function(){return d.apply(this,arguments)};return g.prototype=c.extend(f,b),g.constructor=e,g.extend=e.extend,c.ioc.register(a,g),g},c.namespace=function h(a,b){if("string"==typeof a)return h.call(this,a.split("."),b);var c=a.splice(0,1);return this[c]=this[c]||{},0===a.length?this[c]=b||this[c]:h.call(this[c],a,b)};{var f=(c.ioc=function(){var a={},b=/^function[\s\w]*\((.*)\)[\s]*{/m,c=/\s*,\s*/,d=function(a){return"function"==typeof a?new a:a};return{register:function(b,c,d){if(!d&&a[b])throw Error("Dependency already registered");return a[b]=c,this},unregister:function(b){b="string"==typeof b?[b]:b;for(var c=0;c<b.length;c++)delete a[b[c]];return this},isRegistered:function(b){return!!a[b]},inject:function(e){var f=(b.exec(e)||"  ")[1];if(!f.trim())return e;f=f.split(c);for(var g=0;g<f.length;g++){var h=a[f[g]];if(!h)throw Error('"'+f[g]+'" was never registered');f[g]=d(h)}return e.bind.apply(e,[e].concat(f))},resolve:function(b){if("string"!=typeof b){var c=[];for(var e in b)c.push(this.resolve(b[e]));return c}if(!a[b])throw Error('"'+b+'" was never registered');return d(this.inject(a[b]))},reset:function(){return a={},this}}}(),c.history=function(){var a=b.history,d={};for(var e in a)(function(b){d[b]="function"!=typeof a[b]?a[b]:function(){a[b].apply(a,arguments),d.state=a.state,d.length=a.length,c.events.trigger("history:update",{action:b,state:d.state}).trigger("history:"+b,{state:d.state})}})(e);return d}(),c.events=function(){var a={},b=10;return{trigger:function(b,c){var d=a[b]||[];for(var e in d)for(var f in d[e])d[e][f].handler(c,b);return this},on:function(c,d,e){var f=(e||{}).priority||b,g=(e||{}).context||this;a[c]=a[c]||[],a[c][f]=a[c][f]||[],d="function"==typeof d?[d]:d;for(var h=0;h<d.length;h++)a[c][f].push({handler:d[h].bind(g),id:d[h]});return this},off:function(b,c){a=0===arguments.length?{}:a;var d=a[b]||[];for(var e in d)for(var f in d[e])d[e][f].id==c&&d[e].splice(f,1);return this}}}());c.router=function(){var d=[],e=b.history,f="pushState"in e?"popstate":"hashchange",g={html5Mode:!0},h=function(a){for(var c=0;c<d.length;c++)d[c].url===b.location&&i(d[c].callbacks,a)},i=function(a,b){for(var c=0;c<a.length;c++)a[c](b)};return{start:function(){return c.events.on("history:update",h),this},stop:function(){return a(b).off(f),this},config:function(a){for(var b in a)g[b]=a[b];return this},route:function(a){return d.push({url:a,callbacks:[]}),this},then:function(a){return d[d.length-1].callbacks.push(a),this},navigate:function(){}}}(),c.view=c.Class.extend("View",{_construct:function(b){this.container=b.container?a(b.container):a(this.container)||a("<div>"),this.$=c.extend({},c.extend(b.$||{},this.$||{})),this._initState=[];for(var d in this.$){var e=this.$[d].split(/\s*:\s*/),f=e.splice(0,1)[0];this.add(d,f,e),this._initState[d]=this.$[d].is("input")?this.$[d].val():this.$[d].text()}},add:function(a,b,e){var f=this.container.find(b);return 0===f.length?!1:(this.$[a]=f,e="string"==typeof e?"*"===e.trim()?d.join(" "):e:(e||[]).join(" "),f.on(e,function(a,b){return function(d){c.events.trigger("view:"+a.id+":"+b+" "+d.type,d)}}(this,a)),void 0)},reset:function(){for(var a in this._initState){var b=this.$[a].is("input");this.$[a][b?"val":"text"](this._initState[a])}}}),c.model=c.Class.extend("Model",{_construct:function(){this.properties=c.extend({},this.properties),this._initState=c.extend({},this.properties)},property:function(a,b,c){if("string"==typeof a){if(null==this.properties[a]&&null==b)throw"Property doesn't exist";if(null==b)return this.properties[a];this.properties[a]=b,c||f.trigger("model:"+this.id+":changed",{property:a,value:b})}else for(var d in a)a.hasOwnProperty(d)&&this.property.call(this,d,a[d],b)},reset:function(){this.properties=c.extend({},this._initState)}}),c.presenter=c.Class.extend("Presenter",{models:[],views:[],events:{},_construct:function(){this.views=c.ioc.resolve(this.views),this.models=c.ioc.resolve(this.models),this.view=this.views.length>0?this.views[0]:null,this.model=this.models.length>0?this.models[0]:null;for(var a in this.events){var b=a.split(/\s+/),d=b.splice(0,1);b=0===b.length?[" "]:b;for(var e in b){var f=d+(" "===b[e]?"":" "+b[e]);c.events.on(f,this[this.events[a]].bind(this))}}}})}!function(a){var b={};b.render=function(){console.log("templateengine.get still in development")},a.templates=a.templates||{},a.templates.render=b.render}(c||{}),function(a,b){var c={},d={},e=function(a){var c=b.Deferred(),d=c.promise(),e=b.ajax({async:!0,cache:!0,url:a});return e.success(function(a){c.resolve(a)}),e.error(function(a){c.reject(a)}),d},f=function(a){return d[a]},g=function(a,b){d[a]=b},h=function(a){var c=b.Deferred(),d=c.promise(),h=f(a);return null!=h?c.resolve(h):b.when(e(a)).then(function(b){null!=b&&g(a,b),c.resolve(b)}),d};c.get=function(a){h(a)},a.templates=a.templates||{},a.templates.get=c.get}(c||{},jQuery)}).call(this,jQuery);